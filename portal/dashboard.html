<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Client Dashboard – Jamey Frazee</title>
  <style>
    body{background:#0f172a;color:#e2e8f0;font-family:Merriweather,serif;margin:0;padding:20px}
    .badge{position:fixed;top:20px;right:20px;background:rgba(34,197,94,.15);border:1px solid #22c55e;color:#22c55e;padding:10px 16px;border-radius:8px;font-weight:bold}
    .box{max-width:900px;margin:40px auto;background:#1e293b;padding:40px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.6);text-align:center}
    h1{color:#f1f5f9}
    button{background:#d4af37;color:#0f172a;padding:12px 24px;border:none;border-radius:8px;font-weight:bold;cursor:pointer;margin:10px}
    #logout{background:#dc2626;float:right}
    .section{margin:30px 0}
    ul{list-style:none;padding:0}
    li{margin:15px 0;font-size:1.1rem}
    a{color:#60a5fa}
  </style>
</head>
<body>
  <div class="badge">Secure & Encrypted</div>
  <div class="box">
    <h1>Welcome</h1>
    <p id="email">Loading…</p>
    <button id="logout">Logout</button>

    <div class="section">
      <h2>Your Case Files & Photos</h2>
      <ul id="files">Loading your private files…</ul>
    </div>

    <div class="section">
      <h2>Invoices</h2>
      <p>Invoice system with one-click card payment coming in the next 24 hrs.</p>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-storage-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD0m6KLEVnflqV9b_mbZ22gho6-g5wHU4w",
      authDomain: "jamey-frazee-client-portal.firebaseapp.com",
      projectId: "jamey-frazee-client-portal",
      storageBucket: "jamey-frazee-client-portal.firebasestorage.app",
      messagingSenderId: "693440666268",
      appId: "1:693440666268:web:0d0bf260a94d8afefe2b59"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const storage = firebase.storage();

    auth.onAuthStateChanged(user => {
      if (!user) { location.href = 'index.html'; return; }
      document.getElementById('email').textContent = `Logged in as ${user.email}`;
      loadFiles(user.uid);
    });

    document.getElementById('logout').onclick = () => auth.signOut().then(() => location.href = 'index.html');

    function loadFiles(uid) {
      const list = document.getElementById('files');
      const ref = storage.ref(`clients/${uid}`);
      ref.listAll().then(res => {
        list.innerHTML = '';
        if (res.items.length === 0) list.innerHTML = '<li>No files uploaded yet — they will appear automatically.</li>';
        res.items.forEach(item => {
          item.getDownloadURL().then(url => {
            const li = document.createElement('li');
            li.innerHTML = `<a href="${url}" target="_blank">Download ${item.name}</a>`;
            list.appendChild(li);
          });
        });
      }).catch(() => list.innerHTML = '<li>No files yet.</li>');
    }
  </script>
</body>
</html>
